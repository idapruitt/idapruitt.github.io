<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fixed Image Viewer</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      font-family: sans-serif;
      background-color: #f0f0f0;
    }

    .container {
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .thumbnails {
      display: flex;
      justify-content: center;
      gap: 10px;
      padding: 10px;
      background: #fff;
      border-bottom: 1px solid #ccc;
      z-index: 10;
    }

    .thumbnails img {
      width: 100px;
      height: 70px;
      object-fit: cover;
      cursor: pointer;
      border: 2px solid transparent;
      transition: border 0.3s;
    }

    .thumbnails img:hover {
      border-color: #4CAF50;
    }

    .viewer {
      position: relative;
      flex: 1;
      background: #000;
      overflow: hidden;
      cursor: zoom-in;
      user-select: none;
    }

    .viewer.zoomed {
      cursor: grab;
    }

    .viewer.zoomed:active {
      cursor: grabbing;
    }

    .viewer img {
      position: absolute;
      top: 0;
      left: 0;
      transform-origin: top left;
      transition: transform 0.2s ease;
      user-select: none;
      pointer-events: none;
      max-width: none;
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="thumbnails">
      <img src="images/photo1.jpg" onclick="loadImage('images/photo1.jpg')" />
      <img src="images/photo2.jpg" onclick="loadImage('images/photo2.jpg')" />
      <img src="images/photo3.jpg" onclick="loadImage('images/photo3.jpg')" />
    </div>
    <div class="viewer" id="viewer">
      <img id="mainImage" src="images/photo1.jpg" alt="Main Image" />
    </div>
  </div>

  <script>
    const viewer = document.getElementById('viewer');
    const image = document.getElementById('mainImage');

    let scale = 1;
    let baseScale = 1;
    let zoomFactor = 2;
    let translateX = 0;
    let translateY = 0;
    let isZoomed = false;

    let isDragging = false;
    let dragThreshold = 5;
    let dragStartedAt = { x: 0, y: 0 };
    let startX = null;
    let startY = null;

    function clampTranslation() {
      const viewerRect = viewer.getBoundingClientRect();
      const imgWidth = image.naturalWidth * scale;
      const imgHeight = image.naturalHeight * scale;

      const maxOffsetX = Math.max(0, (imgWidth - viewerRect.width) / 2);
      const maxOffsetY = Math.max(0, (imgHeight - viewerRect.height) / 2);

      translateX = Math.max(-maxOffsetX, Math.min(maxOffsetX, translateX));
      translateY = Math.max(-maxOffsetY, Math.min(maxOffsetY, translateY));
    }

    function applyTransform() {
      clampTranslation();
      const viewerRect = viewer.getBoundingClientRect();
      const offsetX = (viewerRect.width - image.naturalWidth * scale) / 2;
      const offsetY = (viewerRect.height - image.naturalHeight * scale) / 2;
      const x = offsetX + translateX;
      const y = offsetY + translateY;

      image.style.transform = `translate(${x}px, ${y}px) scale(${scale})`;
    }

    function fitImageToViewer() {
      const viewerRect = viewer.getBoundingClientRect();
      const iw = image.naturalWidth;
      const ih = image.naturalHeight;

      const scaleX = viewerRect.width / iw;
      const scaleY = viewerRect.height / ih;

      baseScale = Math.min(scaleX, scaleY);
      scale = baseScale;
      translateX = 0;
      translateY = 0;

      applyTransform();
    }

    viewer.addEventListener('mousedown', (e) => {
      if (!isZoomed) return;
      isDragging = false;
      dragStartedAt = { x: e.clientX, y: e.clientY };
      startX = e.clientX;
      startY = e.clientY;
    });

    viewer.addEventListener('mousemove', (e) => {
      if (!isZoomed || startX === null) return;

      const dxTotal = e.clientX - dragStartedAt.x;
      const dyTotal = e.clientY - dragStartedAt.y;

      if (!isDragging && (Math.abs(dxTotal) > dragThreshold || Math.abs(dyTotal) > dragThreshold)) {
        isDragging = true;
      }

      if (isDragging) {
        const dx = e.clientX - startX;
        const dy = e.clientY - startY;
        translateX += dx;
        translateY += dy;
        startX = e.clientX;
        startY = e.clientY;
        applyTransform();
      }
    });

    viewer.addEventListener('mouseup', () => {
      startX = null;
      startY = null;
    });

    viewer.addEventListener('mouseleave', () => {
      startX = null;
      startY = null;
    });

    viewer.addEventListener('click', (e) => {
      if (isDragging) {
        isDragging = false;
        return;
      }

      const rect = viewer.getBoundingClientRect();
      const clickX = e.clientX - rect.left;
      const clickY = e.clientY - rect.top;

      const imageOffsetX = (clickX - rect.width / 2);
      const imageOffsetY = (clickY - rect.height / 2);

      isZoomed = !isZoomed;
      viewer.classList.toggle('zoomed', isZoomed);

      if (isZoomed) {
        scale = baseScale * zoomFactor;
        translateX = -imageOffsetX * (zoomFactor - 1);
        translateY = -imageOffsetY * (zoomFactor - 1);
      } else {
        scale = baseScale;
        translateX = 0;
        translateY = 0;
      }

      applyTransform();
    });

    function loadImage(src) {
      image.src = src;
      isZoomed = false;
      viewer.classList.remove('zoomed');
    }

    image.onload = fitImageToViewer;
    window.addEventListener('resize', fitImageToViewer);
  </script>

</body>
</html>
