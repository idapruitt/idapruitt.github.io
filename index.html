<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fullscreen Zoom Image Viewer</title>
  <style>
    html, body {
      margin: 0; padding: 0; height: 100%; overflow: hidden;
      background-color: #888;
      font-family: sans-serif;
      user-select: none;
    }
    .container {
      display: flex;
      flex-direction: column;
      height: 100%;
      background-color: #888;
    }
    .thumbnails {
      display: flex;
      justify-content: center;
      gap: 10px;
      padding: 10px;
      background-color: #888;
      z-index: 10;
      transition: opacity 0.3s ease;
      user-select: none;
    }
    .thumbnails.hidden {
      opacity: 0;
      pointer-events: none;
      height: 0;
      padding: 0;
      margin: 0;
      overflow: hidden;
    }
    .thumbnails img {
      width: 100px;
      height: 70px;
      object-fit: cover;
      cursor: pointer;
      border: 2px solid transparent;
      /* Remove hover highlight */
    }
    .viewer {
      position: relative;
      flex: 1;
      background-color: #888;
      overflow: hidden;
      cursor: zoom-in;
    }
    .viewer.zoomed {
      cursor: grab;
    }
    .viewer.zoomed:active {
      cursor: grabbing;
    }
    .viewer img {
      position: absolute;
      top: 0; left: 0;
      transform-origin: top left;
      pointer-events: none;
      max-width: none;
      display: none; /* hidden until loaded */
      will-change: transform;
      user-select: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="thumbnails" id="thumbnails">
      <img src="images/photo1.jpg" onclick="loadImage('images/photo1.jpg')" alt="Thumb 1" />
      <img src="images/photo2.jpg" onclick="loadImage('images/photo2.jpg')" alt="Thumb 2" />
      <img src="images/photo3.jpg" onclick="loadImage('images/photo3.jpg')" alt="Thumb 3" />
    </div>
    <div class="viewer" id="viewer">
      <img id="mainImage" src="images/photo1.jpg" alt="Main Image" />
    </div>
  </div>

  <script>
    const viewer = document.getElementById('viewer');
    const image = document.getElementById('mainImage');
    const thumbnails = document.getElementById('thumbnails');

    let baseScale = 1;      
    let scale = 1;          
    const maxScaleFactor = 5; 
    let translateX = 0;
    let translateY = 0;
    let isZoomed = false;

    let isDragging = false;
    let hasDragged = false;
    let dragStart = { x: 0, y: 0 };
    let lastTranslate = { x: 0, y: 0 };

    function clampTranslation() {
      const viewerRect = viewer.getBoundingClientRect();
      const imgWidth = image.naturalWidth * scale;
      const imgHeight = image.naturalHeight * scale;

      const maxTranslateX = Math.max(0, (imgWidth - viewerRect.width) / 2);
      const maxTranslateY = Math.max(0, (imgHeight - viewerRect.height) / 2);

      translateX = Math.min(maxTranslateX, Math.max(-maxTranslateX, translateX));
      translateY = Math.min(maxTranslateY, Math.max(-maxTranslateY, translateY));
    }

    function applyTransform() {
      clampTranslation();
      const viewerRect = viewer.getBoundingClientRect();
      const offsetX = (viewerRect.width - image.naturalWidth * scale) / 2;
      const offsetY = (viewerRect.height - image.naturalHeight * scale) / 2;
      const x = offsetX + translateX;
      const y = offsetY + translateY;
      image.style.transform = `translate(${x}px, ${y}px) scale(${scale})`;
    }

    function fitImageToViewer() {
      const viewerRect = viewer.getBoundingClientRect();
      const iw = image.naturalWidth;
      const ih = image.naturalHeight;
      if (iw === 0 || ih === 0) return;

      const scaleX = viewerRect.width / iw;
      const scaleY = viewerRect.height / ih;

      baseScale = Math.min(scaleX, scaleY);
      scale = baseScale;
      translateX = 0;
      translateY = 0;
      isZoomed = false;
      viewer.classList.remove('zoomed');
      thumbnails.classList.remove('hidden');

      applyTransform();
      image.style.display = 'block';
    }

    function loadImage(src) {
      image.style.display = 'none';
      image.src = src;
      translateX = 0;
      translateY = 0;
      scale = baseScale;
      isZoomed = false;
      viewer.classList.remove('zoomed');
      thumbnails.classList.remove('hidden');
    }

    viewer.addEventListener('mousedown', e => {
      if (!isZoomed) return;
      isDragging = true;
      hasDragged = false;
      dragStart.x = e.clientX;
      dragStart.y = e.clientY;
      lastTranslate.x = translateX;
      lastTranslate.y = translateY;
      viewer.style.cursor = 'grabbing';
      e.preventDefault();
    });

    viewer.addEventListener('mousemove', e => {
      if (!isDragging) return;
      hasDragged = true;
      const dx = e.clientX - dragStart.x;
      const dy = e.clientY - dragStart.y;
      translateX = lastTranslate.x + dx;
      translateY = lastTranslate.y + dy;
      applyTransform();
    });

    viewer.addEventListener('mouseup', e => {
      if (isDragging) {
        isDragging = false;
        viewer.style.cursor = 'grab';
      }
    });
    viewer.addEventListener('mouseleave', e => {
      if (isDragging) {
        isDragging = false;
        viewer.style.cursor = 'grab';
      }
    });

    viewer.addEventListener('click', e => {
      if (hasDragged) return;

      const rect = viewer.getBoundingClientRect();
      const clickX = e.clientX - rect.left;
      const clickY = e.clientY - rect.top;

      if (!isZoomed) {
        isZoomed = true;
        const viewerWidth = window.innerWidth;
        const viewerHeight = window.innerHeight;

        // Scale image to fill entire viewport (without cropping)
        const scaleX = viewerWidth / image.naturalWidth;
        const scaleY = viewerHeight / image.naturalHeight;
        scale = Math.min(scaleX, scaleY);

        // Calculate translation to center image on click point and fill screen
        const imgWidthScaled = image.naturalWidth * scale;
        const imgHeightScaled = image.naturalHeight * scale;

        const offsetX = (viewerWidth - imgWidthScaled) / 2;
        const offsetY = (viewerHeight - imgHeightScaled) / 2;

        // Translate so clicked point moves to center of viewport
        const clickOffsetX = clickX - offsetX;
        const clickOffsetY = clickY - offsetY;

        translateX = (viewerWidth / 2 - clickX) + (clickOffsetX - imgWidthScaled / 2);
        translateY = (viewerHeight / 2 - clickY) + (clickOffsetY - imgHeightScaled / 2);

        // Clamp translation so no empty edges show
        clampTranslation();

        viewer.classList.add('zoomed');
        thumbnails.classList.add('hidden');
      } else {
        isZoomed = false;
        scale = baseScale;
        translateX = 0;
        translateY = 0;
        viewer.classList.remove('zoomed');
        thumbnails.classList.remove('hidden');
      }
      applyTransform();
    });

    viewer.addEventListener('wheel', e => {
      e.preventDefault();
      if (!image.naturalWidth || !image.naturalHeight) return;

      const rect = viewer.getBoundingClientRect();
      const cursorX = e.clientX - rect.left;
      const cursorY = e.clientY - rect.top;

      const zoomStep = 0.1;
      let newScale = scale - (e.deltaY > 0 ? zoomStep : -zoomStep) * scale;
      newScale = Math.min(Math.max(newScale, baseScale), baseScale * maxScaleFactor);

      if (newScale === scale) return;

      const viewerWidth = rect.width;
      const viewerHeight = rect.height;
      const offsetX = (viewerWidth - image.naturalWidth * scale) / 2 + translateX;
      const offsetY = (viewerHeight - image.naturalHeight * scale) / 2 + translateY;

      const imgCoordX = (cursorX - offsetX) / scale;
      const imgCoordY = (cursorY - offsetY) / scale;

      scale = newScale;

      const newOffsetX = cursorX - imgCoordX * scale;
      const newOffsetY = cursorY - imgCoordY * scale;

      translateX = newOffsetX - (viewerWidth - image.naturalWidth * scale) / 2;
      translateY = newOffsetY - (viewerHeight - image.naturalHeight * scale) / 2;

      isZoomed = scale > baseScale;
      viewer.classList.toggle('zoomed', isZoomed);
      if (isZoomed) {
        thumbnails.classList.add('hidden');
      } else {
        thumbnails.classList.remove('hidden');
      }

      applyTransform();
    }, { passive: false });

    image.onload = fitImageToViewer;
    window.addEventListener('resize', () => {
      if (!isZoomed) {
        fitImageToViewer();
      } else {
        // When zoomed fullscreen, recalc scale to fill viewport on resize
        const viewerWidth = window.innerWidth;
        const viewerHeight = window.innerHeight;
        const scaleX = viewerWidth / image.naturalWidth;
        const scaleY = viewerHeight / image.naturalHeight;
        scale = Math.min(scaleX, scaleY);
        translateX = 0;
        translateY = 0;
        applyTransform();
      }
    });
  </script>
</body>
</html>
