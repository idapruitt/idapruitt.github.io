<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Image Viewer</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body, html {
      width: 100%;
      height: 100%;
      overflow: hidden;
      background-color: #888;
      font-family: sans-serif;
    }

    #loading-screen {
      position: absolute;
      width: 100%;
      height: 100%;
      background: #111;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }

    #progress-bar {
      width: 60%;
      height: 8px;
      background: #444;
      margin-top: 16px;
      border-radius: 4px;
      overflow: hidden;
    }

    #progress-bar-inner {
      height: 100%;
      width: 0%;
      background: #ccc;
      transition: width 0.3s ease;
    }

    .viewer {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background-color: #888;
      transition: background-color 0.3s ease;
    }

    .viewer.zoomed {
      background-color: #000;
    }

    .viewer img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      user-select: none;
      cursor: grab;
      max-width: none;
      max-height: none;
      image-rendering: auto;
    }

    .thumbnails {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      z-index: 2;
    }

    .thumbnail {
      width: 60px;
      height: 40px;
      object-fit: cover;
      cursor: pointer;
      border: none;
      background: none;
    }

    .thumbnails.hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div id="loading-screen">
    <div>loading big paintings</div>
    <div id="progress-bar">
      <div id="progress-bar-inner"></div>
    </div>
  </div>

  <div class="thumbnails" id="thumbnails">
    <img class="thumbnail" src="images/img1.jpg" onclick="setImage(0)" />
    <img class="thumbnail" src="images/img2.jpg" onclick="setImage(1)" />
    <img class="thumbnail" src="images/img3.jpg" onclick="setImage(2)" />
    <img class="thumbnail" src="images/img4.jpg" onclick="setImage(3)" />
    <img class="thumbnail" src="images/img5.jpg" onclick="setImage(4)" />
    <img class="thumbnail" src="images/img6.jpg" onclick="setImage(5)" />
  </div>

  <div class="viewer" id="viewer">
    <img id="main-image" />
  </div>

  <script>
    const viewer = document.getElementById('viewer');
    const image = document.getElementById('main-image');
    const thumbnails = document.getElementById('thumbnails');
    const loadingScreen = document.getElementById('loading-screen');
    const progressBarInner = document.getElementById('progress-bar-inner');

    const images = [
      'images/img1.jpg',
      'images/img2.jpg',
      'images/img3.jpg',
      'images/img4.jpg',
      'images/img5.jpg',
      'images/img6.jpg'
    ];

    let imagesData = [];
    let currentImageIndex = 0;
    let isZoomed = false;
    let scale = 1;
    let baseScale = 1;
    let translateX = 0;
    let translateY = 0;
    let startX = 0;
    let startY = 0;
    let dragging = false;

    function fitImageToViewer() {
      const viewerRect = viewer.getBoundingClientRect();
      const img = imagesData[currentImageIndex];
      if (!img) return;

      const scaleX = viewerRect.width / img.naturalWidth;
      const scaleY = viewerRect.height / img.naturalHeight;
      baseScale = Math.min(scaleX, scaleY, 1);
      scale = baseScale;

      translateX = 0;
      translateY = 0;

      updateImageTransform();
    }

    function updateImageTransform() {
      const viewerRect = viewer.getBoundingClientRect();
      const img = imagesData[currentImageIndex];
      if (!img) return;

      const imgWidth = img.naturalWidth * scale;
      const imgHeight = img.naturalHeight * scale;

      const maxOffsetX = Math.max(0, (imgWidth - viewerRect.width) / 2);
      const maxOffsetY = Math.max(0, (imgHeight - viewerRect.height) / 2);

      translateX = Math.min(maxOffsetX, Math.max(-maxOffsetX, translateX));
      translateY = Math.min(maxOffsetY, Math.max(-maxOffsetY, translateY));

      image.style.transform = `translate(calc(-50% + ${translateX}px), calc(-50% + ${translateY}px)) scale(${scale})`;
    }

    function setImage(index) {
      if (!imagesData[index]) return;
      currentImageIndex = index;

      const { src, naturalWidth, naturalHeight } = imagesData[index];

      image.style.opacity = 0;
      image.style.display = 'none';
      image.style.pointerEvents = 'none';

      const preloadImg = new Image();
      preloadImg.src = src;

      preloadImg.onload = () => {
        image.src = src;
        image.naturalWidth = naturalWidth;
        image.naturalHeight = naturalHeight;

        baseScale = 1;
        scale = baseScale;
        translateX = 0;
        translateY = 0;
        isZoomed = false;

        fitImageToViewer();
        image.style.display = 'block';
        image.style.opacity = 1;
        image.style.pointerEvents = '';
        viewer.classList.remove('zoomed');
        thumbnails.classList.remove('hidden');
      };
    }

    viewer.addEventListener('mousedown', (e) => {
      dragging = true;
      startX = e.clientX;
      startY = e.clientY;
    });

    viewer.addEventListener('mousemove', (e) => {
      if (!dragging || !isZoomed) return;

      const dx = e.clientX - startX;
      const dy = e.clientY - startY;
      translateX += dx;
      translateY += dy;
      startX = e.clientX;
      startY = e.clientY;
      updateImageTransform();
    });

    viewer.addEventListener('mouseup', () => {
      dragging = false;
    });

    viewer.addEventListener('mouseleave', () => {
      dragging = false;
    });

    viewer.addEventListener('click', (e) => {
      if (!isZoomed) {
        isZoomed = true;
        scale = 2;
        const rect = viewer.getBoundingClientRect();
        const clickX = e.clientX - rect.left - rect.width / 2;
        const clickY = e.clientY - rect.top - rect.height / 2;
        translateX = clickX;
        translateY = clickY;

        thumbnails.classList.add('hidden');
        viewer.classList.add('zoomed');
      } else {
        isZoomed = false;
        scale = baseScale;
        translateX = 0;
        translateY = 0;
        thumbnails.classList.remove('hidden');
        viewer.classList.remove('zoomed');
      }
      updateImageTransform();
    });

    viewer.addEventListener('wheel', (e) => {
      e.preventDefault();
      if (!isZoomed) {
        isZoomed = true;
        scale = 2;
        viewer.classList.add('zoomed');
        thumbnails.classList.add('hidden');
      }

      const rect = viewer.getBoundingClientRect();
      const cx = e.clientX - rect.left - rect.width / 2;
      const cy = e.clientY - rect.top - rect.height / 2;

      const prevScale = scale;
      scale += e.deltaY * -0.001;
      scale = Math.min(Math.max(1.6, scale), 10);

      translateX += cx * (scale - prevScale);
      translateY += cy * (scale - prevScale);

      updateImageTransform();
    }, { passive: false });

    function preloadImages(callback) {
      let loaded = 0;
      images.forEach((src, i) => {
        const img = new Image();
        img.src = src;
        img.onload = () => {
          imagesData[i] = img;
          loaded++;
          progressBarInner.style.width = `${(loaded / images.length) * 100}%`;
          if (loaded === images.length) callback();
        };
      });
    }

    preloadImages(() => {
      loadingScreen.style.display = 'none';
      setImage(0);
    });

    window.addEventListener('resize', fitImageToViewer);
  </script>
</body>
</html>
